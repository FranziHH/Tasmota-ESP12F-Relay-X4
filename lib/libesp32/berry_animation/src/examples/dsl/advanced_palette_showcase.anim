# Advanced DSL palette demonstration
# Showcases: Multiple palettes, layering, dynamic switching
# Demonstrates: Complex palette compositions, event-driven control
#
# This creates a sophisticated multi-palette display with interactive control

strip length 60

# Define multiple custom palettes
palette sunset = [
  (0, #FF4500),    # Orange red
  (64, #FF8C00),   # Dark orange
  (128, #FFD700),  # Gold
  (192, #FF69B4),  # Hot pink
  (255, #800080)   # Purple
]

palette ocean = [
  (0, #000080),    # Navy blue
  (64, #0000FF),   # Blue
  (128, #00FFFF),  # Cyan
  (192, #00FF80),  # Spring green
  (255, #008000)   # Green
]

palette fire = [
  (0, #000000),    # Black
  (64, #800000),   # Dark red
  (128, #FF0000),  # Red
  (192, #FF8000),  # Orange
  (255, #FFFF00)   # Yellow
]

# Create base palette animations with different speeds
animation sunset_base = filled(
  rich_palette(sunset, 8s, smooth, 200),
  loop
)
sunset_base.opacity = smooth(100, 255, 15s)
sunset_base.priority = 0

animation ocean_layer = filled(
  rich_palette(ocean, 12s, smooth, 180),
  loop
)
ocean_layer.opacity = linear(50, 200, 10s)
ocean_layer.priority = 5

animation fire_overlay = filled(
  rich_palette(fire, 4s, linear, 220),
  loop
)
fire_overlay.opacity = square(0, 180, 6s, 30)  # Strobe effect
fire_overlay.priority = 10

# Create moving effects using composite colors
animation palette_comet = comet(
  composite([
    rich_palette(sunset, 8s, smooth, 255),
    rich_palette(ocean, 12s, smooth, 255),
    rich_palette(fire, 4s, linear, 255)
  ], overlay),
  8,      # length
  3,      # trail
  2s,     # speed
  loop
)
palette_comet.priority = 20

animation palette_sparkles = twinkle(
  composite([
    rich_palette(sunset, 8s, smooth, 255),
    rich_palette(ocean, 12s, smooth, 255)
  ], overlay),
  8,      # count
  300ms,  # duration
  loop
)
palette_sparkles.priority = 25

# Event handlers for mode switching
variable current_mode = 0

on mode_switch:
  current_mode = (current_mode + 1) % 5
  
  # Clear all current animations
  stop all
  
  # Switch to different display modes
  if current_mode == 0:
    # All layers mode
    run sunset_base
    run ocean_layer
    run fire_overlay
    run palette_comet
    run palette_sparkles
  elif current_mode == 1:
    # Sunset only
    run sunset_base
  elif current_mode == 2:
    # Ocean only  
    run ocean_layer
  elif current_mode == 3:
    # Fire only
    run fire_overlay
  elif current_mode == 4:
    # Effects only
    run palette_comet
    run palette_sparkles

# Auto-mode switching every 20 seconds
on timer(20s):
  trigger mode_switch

# Start with all layers
run sunset_base
run ocean_layer
run fire_overlay
run palette_comet
run palette_sparkles